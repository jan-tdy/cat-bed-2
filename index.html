<!DOCTYPE html>
<html>
<head>
  <title>Inteligentný pelech pre mačky</title>
</head>
<body>
  <h1>Inteligentný pelech pre mačky</h1>

  <h2>Obsadenosť</h2>
  <div id="occupancy"></div>

  <h2>Režim "nerušiť"</h2>
  <div id="dnd"></div>

  <h2>Kŕmenie</h2>
  <div id="feeding"></div>

  <h2>Manuálne kŕmenie</h2>
  <form id="manualFeedForm">
    <label for="feedInfo">Informácie o kŕmení:</label>
    <input type="text" id="feedInfo" name="feedInfo">
    <button type="submit">Nastaviť</button>
  </form>

  <script>
    // Funkcia pre aktualizáciu dát
    function updateData() {
      // Získanie dát z ESP32
      fetch('/occupancy')
        .then(response => response.text())
        .then(data => document.getElementById('occupancy').innerText = data);

      fetch('/dnd')
        .then(response => response.text())
        .then(data => document.getElementById('dnd').innerText = data);

      fetch('/feeding')
        .then(response => response.text())
        .then(data => document.getElementById('feeding').innerText = data);
    }

    // Aktualizácia dát každú sekundu
    setInterval(updateData, 1000);

    // Odoslanie formulára pre manuálne kŕmenie
    document.getElementById('manualFeedForm').addEventListener('submit', function(event) {
      event.preventDefault();
      const feedInfo = document.getElementById('feedInfo').value;
      fetch('/setManualFeed', {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: `feedInfo=${feedInfo}`
      })
      .then(response => response.text())
      .then(data => console.log(data));
    });
  </script>
</body>
</html>
